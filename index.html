<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
		<title>ICS 33 Grades</title>
        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/gradeviewer.css">
        <script type = "text/javascript" src="js/gradeviewer.js"></script>
        <script lang="javascript" src="js/js-xlsx-0.11.18/dist/xlsx.full.min.js"></script>
        <script src="js/zip-reader.js"></script>
    </head>
    <body>
        <header>
            <center><h1>Welcome to ICS 33 Grade Viewer</h1></center>
        </header>
        <body>
            <form>
                <label>Hash ID:</label>
                <input type = "number" name = "hashID">
                <input type = "submit" value = "Enter">
            </form>
            <script>
                // THIS CODE LOGS THE JSON OBJECT TO THE CONSOLE
                var url = "http://localhost:8000/gradesTestFile.xlsm";

                /* set up async GET request */
                var req = new XMLHttpRequest();
                req.open("GET", url, true);
                req.responseType = "arraybuffer";

                req.onload = function(e) {
                var data = new Uint8Array(req.response);
                var workbook = XLSX.read(data, {type:"array"});

                /* DO SOMETHING WITH workbook HERE */
                // The first sheet is the one with the grades
                // This gets its name
                var grades_sheet_name = workbook.SheetNames[0];

                // Get the grades
                var grades_sheet = workbook.Sheets[grades_sheet_name];

                // Convert to JSON
                console.log(XLSX.utils.sheet_to_json(grades_sheet));
                }

                req.send();
            </script>
        </body>
</html>
